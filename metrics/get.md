# Получить данные метрик :lock:

Получить данные метрик. Используется для построения графика. Если задать gadgetId, то будут возвращены данные по массе, температуре, влажности и давлению. Если не задавать gadgetId, то будут возвращены данные массы по всем весам.

## Запрос

`GET /api/v1/metrics`

| Параметр  | Тип    | Описание                                                                           |
|-----------|--------|------------------------------------------------------------------------------------|
| gadgetId  | string | Идентификатор весов. Можно опустить, тогда будут возвращены метрики по всем весам. |
| startDate | string | Дата начала в формате "YYYY-MM-DD"                                                 |
| endDate   | string | Дата окончания в формате "YYYY-MM-DD"                                              |

## Ответ

| Параметр                                  | Тип    | Описание                                                         |
|-------------------------------------------|--------|------------------------------------------------------------------|
| gadgets                                   | array  | Массив весов                                                     |
| &nbsp;&nbsp;gadgets.id                    | string | Идентификатор весов                                              |
| &nbsp;&nbsp;gadgets.metrics               | array  | Массив метрик                                                    |
| &nbsp;&nbsp;&nbsp;&nbsp;gadgets.metrics.t | number | Тип метрики. Отсутствует если не указан gadgetId (всегда масса). |
| &nbsp;&nbsp;&nbsp;&nbsp;gadgets.metrics.v | number | Значение метрики.                                                |
| &nbsp;&nbsp;&nbsp;&nbsp;gadgets.metrics.d | date   | Дата и время сбора метрики                                       |

## Ошибки
| Код ошибки | Описание                                                |
|------------|---------------------------------------------------------|
| 3          | Несуществующий токен                                    |
| 5          | Неверный id                                             |
| 6          | Дата начала должна быть меньше или равна дате окончания |
| 7          | Недостаточно параметров                                 |

### Пример c указанием устройства
`GET /api/v1/metrics?gadgetId=1&startDate=2019-02-01&endDate=2019-02-20`

```JSON
{
    "ok": true,
    "gadgets": [
        {
            "id": "1",
            "metrics": [
                {
                    "t": 1,
                    "v": 54.23,
                    "d": "2019-02-22T20:35:00.000Z"
                },
                {
                    "t": 2,
                    "v": 22,
                    "d": "2019-02-22T20:35:00.000Z"
                },
                {
                    "t": 3,
                    "v": 70,
                    "d": "2019-02-22T20:35:00.000Z"
                }
            ]
        }
    ]
}
```

### Пример без указания устройства
`GET /api/v1/metrics?&startDate=2019-02-01&endDate=2019-02-20`

```JSON
{
    "ok": true,
    "gadgets": [
        {
            "id": "1",
            "metrics": [
                {
                    "v": 54.23,
                    "d": "2019-02-22T20:35:00.000Z"
                },
                {
                    "v": 54.78,
                    "d": "2019-02-22T20:45:00.000Z"
                },
                {
                    "v": 55.43,
                    "d": "2019-02-22T20:55:00.000Z"
                }
            ]
        },
        {
            "id": "2",
            "metrics": [
                {
                    "v": 54.23,
                    "d": "2019-02-22T20:35:00.000Z"
                },
                {
                    "v": 52.78,
                    "d": "2019-02-22T20:45:00.000Z"
                }
            ]
        }
    ]
}
```
